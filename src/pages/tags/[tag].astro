---
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const allProjects = await Astro.glob('../projects/*.md');

  return [
    { params: { tag: "astro" }, props: {projects: allProjects} },
    { params: { tag: "successes" }, props: {projects: allProjects} },
    { params: { tag: "community" }, props: {projects: allProjects} },
    { params: { tag: "blogging" }, props: {projects: allProjects} },
    { params: { tag: "setbacks" }, props: {projects: allProjects} },
    { params: { tag: "learning in public" }, props: {projects: allProjects} },
  ];
}

const { tag } = Astro.params;
const { projects } = Astro.props;
const filteredProjects = projects.filter((project: { frontmatter: { tags: (string | undefined)[]; }; }) => project.frontmatter.tags?.includes(tag));

---
<Layout title={tag ? tag : ''}>
  <p>Projects tagged with {tag}</p>
  <ul>
    <!-- TODO - replace with ProjectCard -->
    {filteredProjects.map((project: any) => <li><a href={project.url}>{project.frontmatter.title}</a></li>)}
  </ul>
</Layout>
